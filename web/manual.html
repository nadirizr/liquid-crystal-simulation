
<HTML>
<HEAD>
   <TITLE>Download and Instructions Manual</TITLE>

</HEAD>
<a name="up"/>
<BODY BGCOLOR="#FFFFFF" vLink=#4C0B5F aLink=#4C0B5F link=#4C0B5F>
<H1><CENTER>Manual Instructions</CENTER></H1>
<br><br>
<H2>Table of Contents:</H2>
<br>
<ul><li><a href="#running">Running the system:</a></li>
<br>
  <ul><li><a href="#prequisites">Prequisites for running the system</a></li></ul>
  <ul><li><a href="#run">How to run the system</a></li></ul>
  <ul><li><a href="#aviz">How to view the simulations in AViz</a></li></ul>
  <ul><li><a href="#gen_statistics">How to generate statistics and graphs</a></li></ul>
</ul>
<ul><li><a href="#structure">General structure and main components:</a></li>
<br>
  <ul><li><a href="#algorithms">algorithms</a></li></ul>
  <ul><li><a href="#models">models</a></li></ul>
  <ul><li><a href="#potentials">potentials</a></li></ul>
  <ul><li><a href="#runs">runs</a></li></ul>
</ul>
<ul><li><a href="#config">How to write a configuration file</a></li></ul>
<ul><li><a href="#potential">How to add a new potential</a></li></ul>
<ul><li><a href="#statistic">How to use the statistic page</a></li></ul>
<ul><li><a href="#aviz_config">How to configure AViz to generate the images</a></li></ul>
<br>
<H2><center><a name="prequisites">Prequisites for running the system:</a></center></H2>
<P>
<b>To run the system you need to have the following:</b><br>
<li>Python 2.4 and up.</li><br>
<li>Swig 1.3 and up: If you want to use the fast version of the Gay-Bernes potential.</li><br>
<li>AViz 5.6 and up: If you want to render and view images of the simulations you run.</li><br>
These are present on Phelafel and Tamnun, and can be downloaded on the <a href="download.html">download page</a>.
<br><br>
All the simulations presented on this website are included with the program.<br>
There is no need to run them again, as both the models and the results are included with the source files.<br>
You can just watch them in AViz if you want and see the statistics.<br>
More details about how to run them on AViz will be <a href="#aviz">explained later</a>.</li>
</P>

<H2><center><a name="run">How to run the system:</a></center></H2>
<P>
Once you have <a href="download.html">downloaded</a> the project, to run it you only need to write in the shell:<br><br>
<tt><strong>./run.sh [MODEL_NAME]</strong></tt><br><br>
Where [MODEL_NAME] should be <b>replaced</b> with  the name of the model you want to use (if you don't write anything it will use the default model).<br>
The [MODEL_NAME] can be one of the following: "2d_small, "3d_small", "2d_large", "3d", "fixed", "sphere" or "default".<br>
<br>
You can find more details about each of the above models under <a href ="#models">"Models"</a> section.<br>
You can also add another model as explained below in <a href=#config>"How to write a configuration file"</a> section.<br>
<br>
NOTE: You should not write "[MODEL_NAME].py" or give it a path!<br>
The system knows to take it from the models directory automatically.<br>
<br>
Additional options for running:<br>
<li>If you need <b><i>help</i></b> you can run the following commands for a list of command line arguments and options:<br>
<br>
<tt><strong>./run.sh -h</strong></tt><br>
OR<br>
<tt><strong>./run.sh --help</strong></tt><br>
<br>
<li>If you wish to override model parameters from the command line, such as to <i><b>start from a different initial temperature without creating\changing</b></i> a configuration file you can run with the command:<br>
<br>
<tt><strong>./run.sh [MODEL_NAME] INITIAL_TEMPERATURE=___</strong></tt><br>
<tt><strong>./run.sh [MODEL_NAME] TWO_SPIN_POTENTIAL=___</strong></tt><br>
<br>
In each of the cases, put the desired parameter instead of the "___".<br></li>
<br>
<li>If you have already started a simulation and stopped before it has finished, the system will ask you if you want to continue the simulation.<br>
Select "Y" for "yes" if you do, and "N" for "no" if not.<br>
If you wish to continue a specific run, look for it in the <b>runs</b> directory in the main project directory, and write:<br>
<br>
<tt><strong>./run.sh [RUN_NAME]</strong></tt>
<br>
Where [RUN_NAME] should be <b>replaced</b> with the aforementioned name of the run in the <b>runs</b> directory.<br>
If the run is incomplete, it will ask you if you wish to continue it, and resume from where it left off.<br>
</li>
<br><br>
<H2><center><a name="aviz">How to view the simulation in AViz:</a></center></H2>
First of all, you need to <a href="download.html">download AViz</a> to be able to peform this.<br>
<br>
After running the system you can render the visual model in AViz by running:<br>
<br>
<tt><strong>./aviz.sh [OUTPUT_TITLE]</strong></tt><br>
<br>
Where [OUTPUT_TITLE] should be replaced by the name of the run directory as shown after the simulation finishes, or simply the model that was run (it will take the last one chronologically).<br>
More details on this are under <a href="#runs">"runs"</a> section.
<br>
To configure AViz the way we did to generate the images on this website, follow these <a href="#aviz_config">instructions</a>.<br>
<br><br>
<H2><center><a name="gen_statistics">How to generate statistics and graphs:</a></center></H2>
If you wish to <b><i>generate some statistics</i></b> of the simulations you have done, that's also very easy - all you need to do is write in the shell (after finishing the simulations): "<br>
<br>
<tt><strong>./generate_stat.sh</strong></tt><br>
<br>
That will create a web page called "compare_chart.html" inside the folder "web" with all of the statistics neatly displayed.<br>
<br>
If you want to <b><i>add the animations from AViz</i></b> to those statistics, you should run the same command with an additional flag:<br>
<br>
<tt><strong>./run.sh --a</strong></tt><br>
OR<br>
<tt><strong>./run.sh --aviz</strong></tt><br>
<br>
This will add the images as PNG files in the "web/models/[MODEL_NAME]" directory (where [MODEL_NAME] is the name of a model that was run in the simulator).<br>
NOTE: <b>You must have <a href="download.html" target="_blanck">AViz</a> installed in order to use it.</b><br>
<br>
More details about using the statistics page are under the<a href="#statistic">"statistics"</a> section.
<br>
<div align="right"><a href="#up">[up]</a></div>
</P>
<br><br>
<H2><center><a name="structure">General structure and main components:</a></center></H2>
<br>
<P>
<center><a href="#algorithms"><img src="algorithms.jpg" height="100"/></a><a href="#models"><img src="models.jpg" height="100"/></a><a href="#potentials"><img src="potentials.jpg" height="100"/></a><a href="#runs"><img src="runs.jpg" height="100"/></a>
<img src="prtsc2.jpg" height="100"/><br><br><img src="prtsc3.jpg" height="100"/></center>

<br>
<ul><font size="+1.5"><b>lc.py</b></font> - This class represents the system that we are working with.
It holds the positions and angles of molecules in a liquid crystal, and can
perform a Monte Carlo Metropolis cooling of the liquid crystal.</ul>
<br>
<ul><font size="+1.5"><b>constants.py</b></font> - Contains physical constants such as Boltzman's constant, Planck's constant and the g factor.<br>
It is possible to add other constant here if they are needed.</ul><br>
<ul><font size="+1.5"><b>utils.py</b></font> - contains some useful methods, some of them can be found in newer editions of Python.</ul>
<br>
<div align="right"><a href="#up">[up]</a></div>
<br>
<H3><center><a name="algorithms">"algorithms" folder:</a></center></H3>
This folder contains the Monte Carlo algorithm methods.
<br><b>You should not change anything here, unless you know what your'e doing.</b><br>
<div align="right"><a href="#up">[up]</a></div>
<br><br>
<H3><center><a name="models">"models" folder:</a></center></H3>
<br>
This is where all model files are.<br>
A model file contains all of the system, algorithm and potential parameters for a simulation.<br>
If you wish to start a simulation, you can choose a pre-existing model or create your own.<br>
<br>
The following models are implemented already and come packaged with the sources:<br>
<ul><li><i>"fixed"</i> - The cylinders will stay at their places.</li></ul>
<ul><li><i>"sphere"</i> - The cylinders can move, and neighbour lists are used to track the closest neighbours.</li></ul>
<ul><li><i>"2d_small"</i> - A system of 3X3 cylinders in 2 dimensions, uses the Gay-Bernes Potential. Periodic boundary conditions in one direction, the other is fixed.</li></ul>
<ul><li><i>"3d_small"</i> - A system of 5X5X5 cylinders in 3 dimensions, uses the Gay-Bernes Potential. Periodic boundary conditions in two directions, the other is fixed.</li></ul>
<ul><li><i>"2d_large"</i> - A system of 10X10 cylinders in 2 dimensions, uses the Gay-Bernes Potential.Periodic boundary conditions in one direction, the other is fixed.</li></ul>
<ul><li><i>"3d"</i> - A system of 10X10X10 cylinders in 3 dimensions, uses the Gay-Bernes Potential, Periodic boundary conditions in two directions, the other is fixed.</li></ul>
<ul><li><i>"default"</i> - A system of 5x5 cylindes in 2 dimensions, with fixed positions.</li></ul>
You can also add another one as written below in <a href="#config">"How to add a configuration file"</a>.<br>
<br>
<div align="right"><a href="#up">[up]</a></div>
<br><br>
<H3><center><a name="potentials">"potentials" folder:</a></center></H3>
This is where all of the potential implementations are.<br>
A potential is responsible for the way the system models interactions between the molecules.<br>
<br>
We have the following potentials approximations implemented:<br> 
<ul>
<li><i>"FixedNearestNeighboursPotential"</i> - The nearest neighbours for each molecule are simply those that are within a certain index range.<br>
This is controlled by the model parameter <b>NEAREST_NEIGHBOURS_MAX_INDEX_RANGE</b>.<br>
A value of 3 to that parameter means that for a molecule at index (x,y) for a 2D system, all neighbours in the square from (x-3,y-3) to (x+3,y+3) will be considered in the potential calculation.<br></li>
<br>
<li><i>"SphereNearestNeighboursPotential"</i> - The nearest neighbours for each molecule are computed dynamically every few steps to be within a defined sphere.<br>
The candidates are chosen using the same model parameter as above <b>NEAREST_NEIGHBOURS_MAX_INDEX_RANGE</b>.<br>
The model parameter <b>NEAREST_NEIGHBOURS_MAX_RADIUS</b> controls the radius of the sphere from the molecule, in which those candidates must reside to be considered as nearest neighbours.<br>
The model parameter <b>NEAREST_NEIGHBOURS_UPDATE_CYCLES</b> controls the number of Metropolis steps between calculations of those neighbours.<br>
A smaller value will mean a more accurate potential, but also a penalty to performance.</li></ul> 
<br>
We have the following potentials implemented:<br>
<ul>
<li><i>"LenardJonesPotential"</i> - an explanation of this potential can be found <a href="http://en.wikipedia.org/wiki/Lennard-Jones_potential">here</a>.</li>
<br>
<li><i>"GayBernesPotential"</i> - an explanation of this potential can be found <a href="http://www.sklogwiki.org/SklogWiki/index.php/Gay-Berne_model">here</a>.</li>
</ul>
<br>
You can also add another potential by following the instructions below in<a href="#potential"> "How to add a new potential"</a>. 
</P>
<br>
<div align="right"><a href="#up">[up]</a></div>
<br>
<H3><center><a name="runs">"runs" folder:</a></center></H3>
After each run of the simulation the system will save all of the states it has gone through, as well as the ".xyz" files for AViz, in a dedicated run directory.<br>
Inside the "runs" folder you can find a sub folder for each simulation you have run so far.<br>
The run directory will have in its name the name of the model you have run, as well as the date and time.<br>
<br>
Any folder like this contains sub folders:<br>
<ul><li><i>"output"</i> - Contains the ".xyz" files used by AViz to render the simulation, as well as a ".lst" list file used by AViz to view the system over time.<br>
It also contains a "info.txt" file that records various statistics over time used by the <a href="#gen_statistics">statistics generator</a>.<br></li></ul>
<ul><li><i>states</i> - Contains all the states the system went through during the simulation.</li></ul>
<ul><li><i>run.log</i> - A log file with all the simulation details shown during the simulation.</li></ul>
<ul><li><i>MODEL_NAME.py</i> - The model file the simulation was run with.</li></ul>
<br>
<div align="right"><a href="#up">[up]</a></div>
<br><br>
<H2><center><a name="config">How to write a configuration file:</a></center></H2>
<P>
<br>
First of all you should go to the library <i>"models"</i>, where you can copy the content of the configuration file "default.py" and name your file as you wish (with a ".py" suffix of course).<br>
You can also copy another file that is more suitable to your needs, and change that.<br>
<br>
Now you only need to change the parameters in your file, so it would be like the system you want to model.<br> 
<br>
The following are some common or important <b>system parameters</b>:<br>
<ul><li><i>DIMENSIONS</i> = [number of cylinders in x direction, number of cylinders in y direction, number of cylinders in z direction]</li></ul>
<ul><li><i>BOUNDARY_CONDITIONS</i> = ["Boundary condition for the first direction", "Boundary condition for the second direction",...,"Boundary condition for the n'th direction"] - <i>"P"</i> for Periodic, <i>"F"</i> for fixed.</li></ul>
<ul><li><i>INITIAL_SPACING</i> = [The spacing between spin locations in x direction, The spacing between spin locations in y direction, The spacing between spin locations in z direction]</li></ul>
<ul><li><i>INITIAL_SPIN_ORIENTATION</i> = [The initial spin orientation vector in x direction, The initial spin orientation vector in y direction, The initial spin orientation vector in z direction]</li></ul>
<br>
There are more parameters you can change but everything is explained in the file itself as well.<br>
<br>
You can change all the <b>potential parameter</b> - <img src="meu.jpg" height="2%"/>,<img src="neu.jpg" height="2%"/> ,<img src="kappa.jpg" height="2%"/> ,<img src="kappa'.jpg" height="2%"/> ,<img src="epsilon0.jpg" height="2%"/>
<br>
<ul><li><i>POTENTIAL</i> = The name of the potential approximation you want to use.<br>
You can choose from: "FixedNearestNeighboursPotential" or "SphereNearestNeighboursPotential" (explained <a href="#potentials">above</a>).<br>
You can also add a new potential as explained below in <a href="#potential">"How to add a new potential"</a> section.</li></ul>
<ul><li><i>TWO_SPINS_POTENTIAL</i> = The name of the potential you want to use.<br>
You can choose from: "GayBernesPotential" or "LenardJonesPotential" (explained <a href="#potentials">above</a>).<br>
You can also add a new potential as explained below in <a href="#potential">"How to add a new potential"</a> section.</li></ul>
<br>
NOTE: You should only write the name of the potential as in the potential file, without a suffix of any kind.<br>
<br>
It is also possible to change settings for nearest neighbours, such as maximum radius for neighbours (explained <a href="#potentials">above</a>).<br>
<br>
You can also change the <b>Cooling and Heating Algorithms properties</b> such as (examples are for cooling but the same for the heating process):
<ul><li><i>MC_COOLER_SPACING_STDEV</i> = The standard deviation of the Gaussian random spacing in the system.</li></ul>
<ul><li><i>MC_COOLER_SPACING_FROM_ORIGINAL_LOCATION_CUTOFF</i> = The maximum radius from the original location where the molecule can be.</li></ul>
<ul><li><i>MC_COOLER_SPIN_STDEV</i> = The standard deviation of the Gaussian random spin orientation.</li></ul>
<ul><li><i>MC_COOLER_METROPOLIS_NUM_STEPS</i> = the number of Metropolis steps to perform in each cooling steps.</li></ul>
<ul><li><i>MC_COOLER_MAX_STEPS</i> = the number of steps in the cooling process to perform the Metropolis algorithm before lowering the temperature further.</li></ul>
<ul><li><i>MC_COOLER_TEMPERATURES</i> = frange(INITIAL_TEMPERATURE, FINAL_TEMPERATURE, -CHANGING_IN_EACH_STEP)</ul>
<ul><li><i>MC_COOLER_AVIZ_OUTPUT_PATH</i> = The path to which to output the AVIZ files</li></ul>
<br>
<font size="+1"><b> You should only change the values and nothing else! </b></font>
<br>
<div align="right"><a href="#up">[up]</a></div>
</P>
<br>
<H2><center><a name="potential">How to add a new potential:</a></center></H2>
<br>
<P>
First of all you should go to the library "potentials", and copy the content of the file "potential.py" and name your file as you wish (with the ".py" suffix of course).<br>
You might opt to copy an existing potential that more closely fits your needs, and create a new file to start with.<br>
<br>
The next step is to change the class name:
<ul>
<li>If you want to add a new type of approximation you can delete everything under "TwoSpinsPotential" and change the name of Potential to the new approximation.</li>
<li>If you want to add a new potential you can delete everything between "Potential" and "TwoSpinsPotential" and change the name of TwoSpinsPotential to the new potential.</li>
</ul>
<br>
Now you need to write the potential calculation code.<br>
Use other potentials as boiler plates, they are well documented.<br>
<br>
The last thing you need to do in order to use your new potential, is to write its name in the configuration file.<br>
You can read more about this in <a href="#config">"How to create a new configuration file" above</a>.)
</P>
<div align="right"><a href="#up">[up]</a></div>
<br><br>
<H2><center><a name="statistic">How to use the statistics page:</a></center></H2>
<br>
The statistics page is what you see under <a href="compare_chart.html">"Simulation Statistics"</a>.<br>
This is an auto-generated statistics webpage that is based on various outputs of the simulations, and it is generated as explained <a href="#gen_statistics">above</a>.<br>
It is a very easy and powerfull way to view and analyze the various system parameters, especially when comparing models to one another.<br>
<br>
The page is divided into 3 sections:<br>
<ul><li>The main chart (above and to the left) is actually a time line of all the simulations, and controls all other charts.<br>
You can select the models you wish to compare, move the time indicator forward or backwards, change the axes to view different system parameters, and change colors and sizes of bubbles to reflect different system parameters.<br>
This is easily explained with the following image:<br>
<center><img src="main_chart_explanation.png" height="50%"\></center></li></ul>
<ul><li>The secondary chart (below and to the left) is used for a high level visualization of parameters between systems aggregated over the entire timeline.<br>
With this chart you can easily view the <b>Energy</b> of two systems as a function of their <b>Temperature</b>, over the entire time.<br>
This is done by selecting the <b>Energy</b> on the Y axis in the main chart, and the <b>Temperature</b> on the X axis, and then checking the desired models.<br></li></ul>
<ul><li>The model visualization panel (above and to the right) displays an image rendered by AViz (see explanation <a href="#aviz">above</a>) for the current system time.<br>
Moving the time line in the main chart changes the image to that of the system, and together with the main chart this shows the exact state of the system at any given time.<br>
If there are several systems selected in the main chart, you can choose the one you want to see via the selection box beneath the image.<br></li></ul>
<br>
Each of the settings in the main chart affects the other charts:<br>
<br>
<ul><li>In order to <i><b>change the axes</b></i> you only need to click on the axis' name and change it to what you want, and the Chart will change respectively.<br>
This will automatically change the axes on the secondary chart below to reflect the system parameters you have chosen to compare over all the timeline.</li></ul>
<ul><li>In order to <i><b>change the time</b></i> you need to choose a place in the timeline scroll-bar, or press the "Play" button to move the timeline forward.<br>
This will also change the image on the right to the correct system state visualization at that time.</li></ul>
<ul><li>In order to <i><b>choose the models you wish to compare</b></i> you need to select the check boxes near the desired model names in the small box on the right of the main chart.<br>
This will automatically update both the secondary chart below and the images on the right to reflect the selected systems.</li></ul>
<ul><li>Another thing you can change is the <b><i>color and size of the points in the chart</i></b>, on the right of the chart, according to temperature for example.<br>
This has the benefit of displaying more data on the main chart, and can distinguish between systems of different sizes or energies.</li></ul>
<ul><li>You can also change the <b><i>type of chart</i></b> - linear to see the full graph, time bubbles to see the system evolution over time, etc...</li></ul>
<br>
You must run the statistic generator with the <b><i>"-a"</i></b> or <b><i>"--aviz"</i></b> flag to see the AViz pictures on the right of the page.<br>
Read more about it in <a href="#gen_statistics">"How to generate statistics and graphs"</a> section.<br>
<br>

<br>
<div align="right"><a href="#up">[up]</a></div>
<br>
</BODY>
</HTML>
